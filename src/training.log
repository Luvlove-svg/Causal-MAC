2025-08-12 01:05:28,994 - INFO - 模型初始化完成，使用设备: cuda
2025-08-12 01:05:28,995 - INFO - 模型参数数量: 628,993
2025-08-12 01:05:32,284 - INFO - 训练样本数: 323, 批次: 41
2025-08-12 01:05:32,284 - INFO - 验证样本数: 40, 批次: 5
2025-08-12 01:05:33,476 - ERROR - 训练失败: torch.nn.functional.binary_cross_entropy and torch.nn.BCELoss are unsafe to autocast.
Many models use a sigmoid layer right before the binary cross entropy layer.
In this case, combine the two layers using torch.nn.functional.binary_cross_entropy_with_logits
or torch.nn.BCEWithLogitsLoss.  binary_cross_entropy_with_logits and BCEWithLogits are
safe to autocast.
2025-08-12 01:05:33,477 - ERROR - Traceback (most recent call last):
  File "D:\我的大学\ccf\agent\Causal-MAC\src\train.py", line 338, in <module>
    train()
  File "D:\我的大学\ccf\agent\Causal-MAC\src\train.py", line 143, in train
    loss = model.compute_loss(pred_relations, relations)
  File "D:\我的大学\ccf\agent\Causal-MAC\src\model\causal_mac.py", line 117, in compute_loss
    return nn.functional.binary_cross_entropy(pred_relations, gt_relations)
  File "D:\Anaconda3\envs\causal-mac-gpu\lib\site-packages\torch\nn\functional.py", line 3554, in binary_cross_entropy
    return torch._C._nn.binary_cross_entropy(input, target, weight, reduction_enum)
RuntimeError: torch.nn.functional.binary_cross_entropy and torch.nn.BCELoss are unsafe to autocast.
Many models use a sigmoid layer right before the binary cross entropy layer.
In this case, combine the two layers using torch.nn.functional.binary_cross_entropy_with_logits
or torch.nn.BCEWithLogitsLoss.  binary_cross_entropy_with_logits and BCEWithLogits are
safe to autocast.

2025-08-12 01:09:53,321 - INFO - 模型初始化完成，使用设备: cuda
2025-08-12 01:09:53,321 - INFO - 模型参数数量: 628,993
2025-08-12 01:09:56,039 - INFO - 训练样本数: 323, 批次: 41
2025-08-12 01:09:56,039 - INFO - 验证样本数: 40, 批次: 5
2025-08-12 01:10:03,503 - INFO - Epoch 1/50 | 批次 0/41 | 批次损失: 0.6621 | 批次准确率: 0.0040
2025-08-12 01:15:00,742 - INFO - Epoch 1/50 | 批次 10/41 | 批次损失: 0.6471 | 批次准确率: 0.0045
